---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Tarjeta from '../../components/Tarjeta.astro';

const allPosts = await getCollection('blog', ({ data }) => data.draft !== true);
---

<Layout title="Blog" description="Lista de publicaciones">
  <header class="page-header">
    <div class="container">
      <h1>Blog</h1>
      <p class="intro">Últimas publicaciones y recursos sobre Astro — rendimiento, componentes y buenas prácticas.</p>
    </div>
  </header>

  <div class="posts-grid">
    {allPosts.map(post => (
      <a href={`/blog/${post.id}`}>
        <Tarjeta
          titulo={post.data.title}
          descripcion={post.data.description || ""}
          imagen={post.data.image}
          tags={post.data.tags}
        />
      </a>
    ))}
  </div>
</Layout>

<style>
  :root {
    --bg: #0f1724;
    --surface: #0b1220;
    --muted: #9aa4b2;
    --accent: #7c3aed;
    --card: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
    --glass: rgba(255,255,255,0.03);
  }

  html,body { background: var(--bg); color: #e6eef8; font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }

  .page-header { padding: 2.25rem 0 1.5rem; background: linear-gradient(180deg, rgba(124,58,237,0.06), transparent); }
  .page-header .container { max-width:1100px; margin: 0 auto; padding: 0 1rem; text-align:center; }
  .page-header h1 { margin:0; font-size:2.25rem; line-height:1.05; color: #f3f7fb; letter-spacing:-0.02em; }
  .page-header .intro { margin-top:.5rem; color: var(--muted); font-size:1rem; max-width:760px; margin-left:auto; margin-right:auto; }

  .posts-grid {
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1.25rem;
    max-width: 1100px;
    margin: 1.75rem auto 3.5rem auto;
    padding: 0 1rem;
    align-items:start;
  }

  /* Make the whole anchor look like a card */
  .posts-grid a {
    text-decoration:none;
    display:block;
    width:100%;
    height:100%;
    border-radius:12px;
    background: var(--card);
    box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.03);
    backdrop-filter: blur(6px);
  }

  .posts-grid a:focus,
  .posts-grid a:hover {
    transform: translateY(-6px);
    box-shadow: 0 18px 40px rgba(7,10,30,0.7);
    outline: none;
  }

  /* Ensure inner component stretches and images behave */
  .posts-grid a > * { display:block; height:100%; }
  .posts-grid a img { display:block; width:100%; height:auto; max-height:180px; object-fit:cover; }

  /* Small tag/metadata tweaks if Tarjeta renders them */
  .posts-grid a .tags { margin-top: .5rem; display:flex; gap:.5rem; flex-wrap:wrap; }
  .posts-grid a .tag { font-size:.75rem; padding:.25rem .5rem; background:var(--glass); color:var(--muted); border-radius:999px; }

  @media (max-width:920px) {
    .page-header h1 { font-size:2rem; }
    .posts-grid { gap: 1rem; }
  }

  @media (max-width:720px) {
    .page-header h1 { font-size:1.5rem; }
    .posts-grid { grid-template-columns: 1fr; margin: 1rem auto 2rem auto; }
    .posts-grid a { border-radius:10px; }
  }
</style>